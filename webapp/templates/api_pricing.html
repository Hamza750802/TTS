{% extends 'base.html' %}
{% block title %}API Pricing ‚Äî Cheap TTS{% endblock %}

{% block content %}
<div style="max-width: 900px; margin: 0 auto;">
    <div style="text-align: center; margin-bottom: 40px;">
        <h1 style="font-size: 36px; margin-bottom: 12px;">üîå Text-to-Speech API</h1>
        <p style="color: #6b7280; font-size: 18px; max-width: 600px; margin: 0 auto;">
            Add natural-sounding voices to your apps, websites, and products.
            <br>Simple REST API. Start building in minutes.
        </p>
    </div>

    <!-- API Overview Section -->
    <div style="background: linear-gradient(135deg, #1f2937 0%, #374151 100%); border-radius: 16px; padding: 32px; margin-bottom: 40px; color: white;">
        <h2 style="margin-top: 0; margin-bottom: 24px; font-size: 24px;">What can you build?</h2>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 24px;">
            <div style="background: rgba(255,255,255,0.1); border-radius: 12px; padding: 16px;">
                <div style="font-size: 24px; margin-bottom: 8px;">üéß</div>
                <div style="font-weight: 600; margin-bottom: 4px;">Audiobooks & Podcasts</div>
                <div style="font-size: 13px; color: #9ca3af;">Convert articles and books to audio</div>
            </div>
            <div style="background: rgba(255,255,255,0.1); border-radius: 12px; padding: 16px;">
                <div style="font-size: 24px; margin-bottom: 8px;">ü§ñ</div>
                <div style="font-weight: 600; margin-bottom: 4px;">Voice Assistants</div>
                <div style="font-size: 13px; color: #9ca3af;">Add voice to chatbots and AI apps</div>
            </div>
            <div style="background: rgba(255,255,255,0.1); border-radius: 12px; padding: 16px;">
                <div style="font-size: 24px; margin-bottom: 8px;">üé¨</div>
                <div style="font-weight: 600; margin-bottom: 4px;">Video Voiceovers</div>
                <div style="font-size: 13px; color: #9ca3af;">Generate narration for videos</div>
            </div>
            <div style="background: rgba(255,255,255,0.1); border-radius: 12px; padding: 16px;">
                <div style="font-size: 24px; margin-bottom: 8px;">‚ôø</div>
                <div style="font-weight: 600; margin-bottom: 4px;">Accessibility</div>
                <div style="font-size: 13px; color: #9ca3af;">Make content accessible to all</div>
            </div>
        </div>
        
        <!-- Code Example -->
        <div style="background: #111827; border-radius: 12px; padding: 20px; font-family: 'Monaco', 'Menlo', monospace; font-size: 13px; overflow-x: auto;">
            <div style="color: #6b7280; margin-bottom: 8px;"># Generate speech with one API call</div>
            <div><span style="color: #f472b6;">curl</span> <span style="color: #fbbf24;">-X POST</span> https://cheaptts.com/api/v1/synthesize \</div>
            <div style="padding-left: 20px;"><span style="color: #fbbf24;">-H</span> <span style="color: #34d399;">"X-API-Key: your_api_key"</span> \</div>
            <div style="padding-left: 20px;"><span style="color: #fbbf24;">-H</span> <span style="color: #34d399;">"Content-Type: application/json"</span> \</div>
            <div style="padding-left: 20px;"><span style="color: #fbbf24;">-d</span> <span style="color: #34d399;">'{"text": "Hello world!", "voice": "en-US-AriaNeural"}'</span></div>
        </div>
    </div>

    <!-- Features Grid -->
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 40px;">
        <div style="background: white; border: 1px solid #e5e7eb; border-radius: 12px; padding: 20px;">
            <div style="font-size: 20px; margin-bottom: 8px;">üéôÔ∏è 550+ Voices</div>
            <p style="color: #6b7280; font-size: 14px; margin: 0;">Natural-sounding neural voices in 153 languages. Male, female, and child voices available.</p>
        </div>
        <div style="background: white; border: 1px solid #e5e7eb; border-radius: 12px; padding: 20px;">
            <div style="font-size: 20px; margin-bottom: 8px;">üé≠ Emotion Control</div>
            <p style="color: #6b7280; font-size: 14px; margin: 0;">47 voices support emotions like cheerful, sad, angry, excited, and more via SSML.</p>
        </div>
        <div style="background: white; border: 1px solid #e5e7eb; border-radius: 12px; padding: 20px;">
            <div style="font-size: 20px; margin-bottom: 8px;">üë• Multi-Speaker</div>
            <p style="color: #6b7280; font-size: 14px; margin: 0;">Create dialogues with multiple voices in a single request. Perfect for podcasts.</p>
        </div>
        <div style="background: white; border: 1px solid #e5e7eb; border-radius: 12px; padding: 20px;">
            <div style="font-size: 20px; margin-bottom: 8px;">‚ö° Fast & Reliable</div>
            <p style="color: #6b7280; font-size: 14px; margin: 0;">Streaming support for real-time playback. High availability with 99.9% uptime.</p>
        </div>
        <div style="background: white; border: 1px solid #e5e7eb; border-radius: 12px; padding: 20px;">
            <div style="font-size: 20px; margin-bottom: 8px;">üìÑ Subtitles</div>
            <p style="color: #6b7280; font-size: 14px; margin: 0;">Get word-level timestamps and SRT/VTT subtitle files with your audio.</p>
        </div>
        <div style="background: white; border: 1px solid #e5e7eb; border-radius: 12px; padding: 20px;">
            <div style="font-size: 20px; margin-bottom: 8px;">üîß Easy Integration</div>
            <p style="color: #6b7280; font-size: 14px; margin: 0;">Simple REST API. Embeddable widget with copy-paste code. Works everywhere.</p>
        </div>
    </div>

    <!-- What You Get Banner -->
    <div style="background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%); border: 2px solid #10b981; border-radius: 12px; padding: 20px; margin-bottom: 30px; text-align: center;">
        <p style="color: #065f46; font-size: 15px; margin: 0;">
            <strong>‚úÖ All plans include:</strong> API Keys, Embeddable Widget, Public Widget URL, Full API Docs, All 500+ Voices
        </p>
    </div>

    <h2 style="text-align: center; margin-bottom: 24px; font-size: 28px;">Choose Your Plan</h2>

    <!-- Pricing Cards -->
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 24px; margin-bottom: 40px;">
        
        <!-- Starter Plan -->
        <div style="background: white; border: 2px solid #e5e7eb; border-radius: 16px; padding: 28px; text-align: center; transition: all 0.2s ease;">
            <div style="background: #f3f4f6; color: #374151; padding: 6px 16px; border-radius: 20px; display: inline-block; font-size: 13px; font-weight: 600; margin-bottom: 16px;">STARTER</div>
            <div style="font-size: 48px; font-weight: 800; color: #1f2937; margin-bottom: 8px;">
                $9<span style="font-size: 18px; font-weight: 500; color: #6b7280;">/mo</span>
            </div>
            <p style="color: #6b7280; font-size: 14px; margin-bottom: 24px;">Perfect for side projects & MVPs</p>
            
            <ul style="text-align: left; list-style: none; padding: 0; margin: 0 0 24px 0; font-size: 14px; color: #374151;">
                <li style="padding: 10px 0; border-bottom: 1px solid #f3f4f6;">‚úÖ <strong>100,000</strong> characters/month</li>
                <li style="padding: 10px 0; border-bottom: 1px solid #f3f4f6;">‚úÖ API Key access</li>
                <li style="padding: 10px 0; border-bottom: 1px solid #f3f4f6;">‚úÖ Embeddable widget</li>
                <li style="padding: 10px 0; border-bottom: 1px solid #f3f4f6;">‚úÖ All 500+ voices</li>
                <li style="padding: 10px 0;">‚úÖ Email support</li>
            </ul>
            
            {% if current_user.is_authenticated %}
                {% if current_user.api_tier == 'starter' %}
                    <div class="btn" style="width: 100%; display: block; text-align: center; background: #10b981; cursor: default;">
                        ‚úì Current Plan
                    </div>
                {% else %}
                    <button onclick="subscribeAPI('api_starter')" class="btn" style="width: 100%; display: block; text-align: center;">
                        Get Starter - $9/mo
                    </button>
                {% endif %}
            {% else %}
                <a href="{{ url_for('signup', next='/api-pricing', api_plan='starter') }}" class="btn" style="width: 100%; display: block; text-align: center;">
                    Sign Up for Starter - $9/mo
                </a>
            {% endif %}
        </div>
        
        <!-- Pro Plan -->
        <div style="background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%); border: 2px solid #3b82f6; border-radius: 16px; padding: 28px; text-align: center; position: relative;">
            <div style="position: absolute; top: -12px; left: 50%; transform: translateX(-50%); background: linear-gradient(90deg, #3b82f6, #8b5cf6); color: white; padding: 6px 20px; border-radius: 20px; font-size: 12px; font-weight: 700;">MOST POPULAR</div>
            <div style="background: #3b82f6; color: white; padding: 6px 16px; border-radius: 20px; display: inline-block; font-size: 13px; font-weight: 600; margin-bottom: 16px; margin-top: 8px;">PRO</div>
            <div style="font-size: 48px; font-weight: 800; color: #1f2937; margin-bottom: 8px;">
                $29<span style="font-size: 18px; font-weight: 500; color: #6b7280;">/mo</span>
            </div>
            <p style="color: #6b7280; font-size: 14px; margin-bottom: 24px;">For apps with real users</p>
            
            <ul style="text-align: left; list-style: none; padding: 0; margin: 0 0 24px 0; font-size: 14px; color: #374151;">
                <li style="padding: 10px 0; border-bottom: 1px solid rgba(59,130,246,0.2);">‚úÖ <strong>500,000</strong> characters/month</li>
                <li style="padding: 10px 0; border-bottom: 1px solid rgba(59,130,246,0.2);">‚úÖ API Key access</li>
                <li style="padding: 10px 0; border-bottom: 1px solid rgba(59,130,246,0.2);">‚úÖ Embeddable widget</li>
                <li style="padding: 10px 0; border-bottom: 1px solid rgba(59,130,246,0.2);">‚úÖ All 500+ voices</li>
                <li style="padding: 10px 0;">‚úÖ Priority support</li>
            </ul>
            
            {% if current_user.is_authenticated %}
                {% if current_user.api_tier == 'pro' %}
                    <div class="btn primary" style="width: 100%; display: block; text-align: center; background: #10b981; cursor: default;">
                        ‚úì Current Plan
                    </div>
                {% else %}
                    <button onclick="subscribeAPI('api_pro')" class="btn primary" style="width: 100%; display: block; text-align: center;">
                        Get Pro - $29/mo
                    </button>
                {% endif %}
            {% else %}
                <a href="{{ url_for('signup', next='/api-pricing', api_plan='pro') }}" class="btn primary" style="width: 100%; display: block; text-align: center;">
                    Sign Up for Pro - $29/mo
                </a>
            {% endif %}
        </div>
        
        <!-- Enterprise/Custom Plan -->
        <div style="background: white; border: 2px solid #e5e7eb; border-radius: 16px; padding: 28px; text-align: center; transition: all 0.2s ease;">
            <div style="background: #1f2937; color: white; padding: 6px 16px; border-radius: 20px; display: inline-block; font-size: 13px; font-weight: 600; margin-bottom: 16px;">ENTERPRISE</div>
            <div style="font-size: 48px; font-weight: 800; color: #1f2937; margin-bottom: 8px;">
                Custom
            </div>
            <p style="color: #6b7280; font-size: 14px; margin-bottom: 24px;">Need more than 500K chars/month?</p>
            
            <ul style="text-align: left; list-style: none; padding: 0; margin: 0 0 24px 0; font-size: 14px; color: #374151;">
                <li style="padding: 10px 0; border-bottom: 1px solid #f3f4f6;">‚úÖ <strong>Unlimited</strong> characters</li>
                <li style="padding: 10px 0; border-bottom: 1px solid #f3f4f6;">‚úÖ Volume discounts</li>
                <li style="padding: 10px 0; border-bottom: 1px solid #f3f4f6;">‚úÖ Dedicated support</li>
                <li style="padding: 10px 0; border-bottom: 1px solid #f3f4f6;">‚úÖ Custom SLA</li>
                <li style="padding: 10px 0;">‚úÖ Invoice billing</li>
            </ul>
            
            <a href="mailto:sales@cheaptts.com?subject=Enterprise%20API%20Plan%20Inquiry" class="btn" style="width: 100%; display: block; text-align: center;">
                Contact Sales
            </a>
        </div>
    </div>

    <!-- Current Usage (for logged in users with API access) -->
    {% if current_user.is_authenticated and current_user.api_tier and current_user.api_tier != 'none' %}
    <div style="background: #f9fafb; border: 1px solid #e5e7eb; border-radius: 12px; padding: 24px; margin-bottom: 30px;">
        <h3 style="margin-top: 0; margin-bottom: 16px; font-size: 18px;">üìä Your Current Usage</h3>
        {% set limit = 100000 if current_user.api_tier == 'starter' else 500000 %}
        {% set usage = current_user.api_chars_used or 0 %}
        {% set percent = (usage / limit * 100) | round(1) if limit > 0 else 0 %}
        <div style="margin-bottom: 12px;">
            <span style="font-weight: 600;">{{ '{:,}'.format(usage) }}</span> / {{ '{:,}'.format(limit) }} characters used
            <span style="float: right; color: {% if percent > 80 %}#ef4444{% elif percent > 50 %}#f59e0b{% else %}#10b981{% endif %};">{{ percent }}%</span>
        </div>
        <div style="background: #e5e7eb; border-radius: 8px; height: 12px; overflow: hidden;">
            <div style="background: {% if percent > 80 %}#ef4444{% elif percent > 50 %}#f59e0b{% else %}#10b981{% endif %}; height: 100%; width: {{ percent }}%; transition: width 0.3s;"></div>
        </div>
    </div>
    {% endif %}

    <!-- Simple comparison note -->
    <div style="background: #f9fafb; border: 1px solid #e5e7eb; border-radius: 12px; padding: 20px; margin-bottom: 30px; text-align: center;">
        <p style="color: #6b7280; font-size: 14px; margin: 0;">
            <strong>üí° Looking to use TTS on this website instead?</strong><br>
            The <a href="{{ url_for('subscribe') if current_user.is_authenticated else url_for('signup') }}" style="color: #3b82f6;">$7.99/month web plan</a> gives you unlimited access to our online TTS tool.
        </p>
    </div>

    <!-- API Endpoints Preview -->
    <div style="background: white; border: 1px solid #e5e7eb; border-radius: 16px; padding: 28px; margin-bottom: 30px;">
        <h3 style="margin-top: 0; margin-bottom: 20px; font-size: 20px;">üì° API Endpoints</h3>
        <div style="display: grid; gap: 16px;">
            <div style="background: #f9fafb; border-radius: 8px; padding: 16px;">
                <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                    <span style="background: #10b981; color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: 600;">POST</span>
                    <code style="font-size: 14px; color: #374151;">/api/v1/synthesize</code>
                </div>
                <p style="color: #6b7280; font-size: 13px; margin: 0;">Convert text to speech. Returns MP3 audio. Supports SSML for emotions.</p>
            </div>
            <div style="background: #f9fafb; border-radius: 8px; padding: 16px;">
                <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                    <span style="background: #3b82f6; color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: 600;">GET</span>
                    <code style="font-size: 14px; color: #374151;">/api/voices</code>
                </div>
                <p style="color: #6b7280; font-size: 13px; margin: 0;">List all 550+ available voices with language, gender, and emotion support info.</p>
            </div>
            <div style="background: #f9fafb; border-radius: 8px; padding: 16px;">
                <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                    <span style="background: #10b981; color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: 600;">POST</span>
                    <code style="font-size: 14px; color: #374151;">/api/v1/synthesize (streaming)</code>
                </div>
                <p style="color: #6b7280; font-size: 13px; margin: 0;">Stream audio in real-time for instant playback. Great for voice assistants.</p>
            </div>
        </div>
        <p style="margin-top: 16px; margin-bottom: 0; font-size: 13px; color: #6b7280;">
            üìö Full API documentation available after signup in your dashboard.
        </p>
    </div>

    <!-- Code Examples -->
    <div style="background: white; border: 1px solid #e5e7eb; border-radius: 16px; padding: 28px; margin-bottom: 30px;">
        <h3 style="margin-top: 0; margin-bottom: 20px; font-size: 20px;">üíª Code Examples</h3>
        
        <!-- Python Example -->
        <div style="margin-bottom: 20px;">
            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
                <span style="font-size: 18px;">üêç</span>
                <span style="font-weight: 600; color: #374151;">Python</span>
            </div>
            <div style="background: #1f2937; border-radius: 8px; padding: 16px; font-family: 'Monaco', 'Menlo', monospace; font-size: 12px; overflow-x: auto; color: #e5e7eb;">
<pre style="margin: 0; white-space: pre-wrap;"><span style="color: #f472b6;">import</span> requests

<span style="color: #6b7280;"># Step 1: Generate the audio</span>
response = requests.post(
    <span style="color: #34d399;">"https://cheaptts.com/api/v1/synthesize"</span>,
    headers={<span style="color: #34d399;">"X-API-Key"</span>: <span style="color: #34d399;">"your_api_key"</span>},
    json={
        <span style="color: #34d399;">"text"</span>: <span style="color: #34d399;">"Hello, welcome to my app!"</span>,
        <span style="color: #34d399;">"voice"</span>: <span style="color: #34d399;">"en-US-AriaNeural"</span>
    }
)

data = response.json()
<span style="color: #f472b6;">if</span> data[<span style="color: #34d399;">"success"</span>]:
    <span style="color: #6b7280;"># Step 2: Download the audio file</span>
    audio = requests.get(data[<span style="color: #34d399;">"audio_url"</span>])
    <span style="color: #f472b6;">with</span> <span style="color: #60a5fa;">open</span>(<span style="color: #34d399;">"output.mp3"</span>, <span style="color: #34d399;">"wb"</span>) <span style="color: #f472b6;">as</span> f:
        f.write(audio.content)</pre>
            </div>
        </div>
        
        <!-- JavaScript Example -->
        <div>
            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
                <span style="font-size: 18px;">‚ö°</span>
                <span style="font-weight: 600; color: #374151;">JavaScript</span>
            </div>
            <div style="background: #1f2937; border-radius: 8px; padding: 16px; font-family: 'Monaco', 'Menlo', monospace; font-size: 12px; overflow-x: auto; color: #e5e7eb;">
<pre style="margin: 0; white-space: pre-wrap;"><span style="color: #6b7280;">// Step 1: Generate the audio</span>
<span style="color: #f472b6;">const</span> response = <span style="color: #f472b6;">await</span> <span style="color: #60a5fa;">fetch</span>(<span style="color: #34d399;">"https://cheaptts.com/api/v1/synthesize"</span>, {
    method: <span style="color: #34d399;">"POST"</span>,
    headers: {
        <span style="color: #34d399;">"X-API-Key"</span>: <span style="color: #34d399;">"your_api_key"</span>,
        <span style="color: #34d399;">"Content-Type"</span>: <span style="color: #34d399;">"application/json"</span>
    },
    body: JSON.<span style="color: #60a5fa;">stringify</span>({
        text: <span style="color: #34d399;">"Hello, welcome to my app!"</span>,
        voice: <span style="color: #34d399;">"en-US-AriaNeural"</span>
    })
});

<span style="color: #f472b6;">const</span> data = <span style="color: #f472b6;">await</span> response.<span style="color: #60a5fa;">json</span>();
<span style="color: #f472b6;">if</span> (data.success) {
    <span style="color: #6b7280;">// Step 2: Play or download the audio</span>
    <span style="color: #f472b6;">const</span> audio = <span style="color: #f472b6;">new</span> <span style="color: #60a5fa;">Audio</span>(data.audio_url);
    audio.<span style="color: #60a5fa;">play</span>();
}</pre>
            </div>
        </div>
    </div>

    <!-- FAQ -->
    <div style="margin-bottom: 30px;">
        <h3 style="margin-bottom: 16px;">‚ùì Quick Questions</h3>
        
        <details style="background: white; border: 1px solid #e5e7eb; border-radius: 8px; padding: 16px; margin-bottom: 12px;">
            <summary style="cursor: pointer; font-weight: 600; color: #374151;">What do I get when I subscribe?</summary>
            <p style="margin-top: 12px; color: #6b7280; font-size: 14px;">Instantly! You'll get access to your API keys, embeddable widget code, and a public widget URL you can share. Start integrating TTS into your app right away.</p>
        </details>
        
        <details style="background: white; border: 1px solid #e5e7eb; border-radius: 8px; padding: 16px; margin-bottom: 12px;">
            <summary style="cursor: pointer; font-weight: 600; color: #374151;">What happens if I hit my character limit?</summary>
            <p style="margin-top: 12px; color: #6b7280; font-size: 14px;">API calls will return an error. You can upgrade to Pro for 5x more characters, or wait for your limit to reset next month.</p>
        </details>
        
        <details style="background: white; border: 1px solid #e5e7eb; border-radius: 8px; padding: 16px; margin-bottom: 12px;">
            <summary style="cursor: pointer; font-weight: 600; color: #374151;">Can I cancel anytime?</summary>
            <p style="margin-top: 12px; color: #6b7280; font-size: 14px;">Yes! Cancel anytime from your account settings. No questions asked.</p>
        </details>
    </div>

    <!-- CTA for logged-in users without API -->
    {% if current_user.is_authenticated and (not current_user.api_tier or current_user.api_tier == 'none') %}
    <div style="text-align: center; padding: 30px; background: linear-gradient(135deg, #eff6ff 0%, #f5f3ff 100%); border-radius: 16px; border: 1px solid #e5e7eb;">
        <h3 style="margin-top: 0;">üöÄ Ready to build?</h3>
        <p style="color: #6b7280; margin-bottom: 20px;">Choose a plan above and get your API keys in seconds.</p>
    </div>
    {% endif %}
</div>

<script>
function subscribeAPI(planType) {
    fetch('/create-checkout-session', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ plan_type: planType })
    })
    .then(response => {
        // Check if redirected to login (not authenticated)
        if (response.redirected) {
            window.location.href = '/signup';
            return;
        }
        return response.json();
    })
    .then(data => {
        if (!data) return;
        if (data.url) {
            window.location.href = data.url;
        } else if (data.error) {
            alert('Error: ' + data.error);
        }
    })
    .catch(error => {
        alert('Something went wrong. Please try again.');
        console.error('Error:', error);
    });
}
</script>
{% endblock %}
